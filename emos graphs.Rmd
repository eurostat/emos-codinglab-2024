---
title: "emos"
author: "Maripaz Venegas"
date: "2024-04-22"
output: html_document
---

# Libraries

```{r}
library(restatapi)
library(ggplot2)
library(restatapi)
library(giscoR) 
library(data.table)
library(chron) 
library(reshape2)
library(kableExtra)
#library(tmap) 
library(highcharter)
library(plotly)
```

# Population reporting noise from neighbours or from the street, EU (1), 2011-2020
https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Quality_of_life_indicators_-_natural_and_living_environment

## Data
```{r}
idenv="ilc_mddw01"
dates=2011:2020

env=get_eurostat_data(idenv, filters = list(hhtyp="TOTAL", incgrp="TOTAL", geo="EU27_2020", time=dates))
```

## Graph
```{r}

ggplot(env, aes(x=time, y=values, group=1)) +

  scale_y_continuous(limits=c(0,20), breaks=seq(0,20,2))+
  geom_line(color="orange", linewidth=1) +
  theme_minimal()+
  labs(
    title= (paste0("Population reporting noise from neighbours or from the street, \n EU(\U00B9)",dates[1],"-",dates[length(dates)])),
    subtitle=paste("(%)"),
    caption=paste0("(\U00B9) Estimate \n Source: Eurostat (online data code: ",idenv, ")"))+
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        axis.line.x = element_line(colour = "black",linetype = "solid"),
        axis.ticks.x= element_line(color = "black",
                                  linewidth = 0.2),
        axis.ticks.length.x = unit(0.2,"cm"),
        plot.caption = element_text(hjust = 0),
        plot.title = element_text(hjust = 0, face = "bold")
            )+
  ylab("")+
  xlab("")
```


# Population reporting noise from neighbours or from the street, by income situation, 2020
https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Quality_of_life_indicators_-_natural_and_living_environment

## Data

```{r}
countries <- as.factor(c("EU27_2020","BE", "BG","CZ","DK", "DE", "EE","IE","EL","ES","FR",
                         "HR", "IT","CY","LV","LT","LU","HU","MT","NL","AT","PL","PT","RO",
                         "SI","SK","FI","SE","UK","IS","LI","NO","CH","ME", "MK", "AL", "RS","TR"))

cntr <- as.factor(c("EU-27", "Belgium", "Bulgaria", "Czechia", "Denmark", "Germany", "Estonia", "Ireland",
                    "Greece", "Spain", "France", "Croatia", "Italy", "Cyprus", "Latvia", "Lithuania",
                    "Luxembourg", "Hungary", "Malta", "Netherlands", "Austria", "Poland","Portugal", "Romania",
                    "Slovenia", "Slovakia", "Finland", "Sweden","United Kingdom", "Iceland", "Liechtenstein",
                    "Norway", "Switzerland", "Montenegro", "North Macedonia", "Albania", "Serbia", "Turkey"))
```

```{r}
idenv2="ilc_mddw01"
date=2020

env2=get_eurostat_data(idenv2, filters = list(incgrp=c("B_MD60", "TOTAL"), hhtyp="TOTAL",time=date, geo=countries))

env2=env2[order(env2$geo),]

#env2=cbind(env2, cntr)

#env2=env2[!(geo %in% c("EA18", "EA19", "EU27_2020")), ]
```

## Graph
```{r}
ggplot(data=env2, aes(x=geo, y=values, fill=incgrp)) +
  scale_y_continuous(limits=c(0,40), breaks=seq(0,40,5))+
  geom_bar(stat="identity", position=position_dodge(), width = 0.5)+
  theme_minimal()+
   labs(title= (paste0("Population reporting noise from neighbours or from the street by, \n income situation, ", date)),
    subtitle=paste("(%)"),
  caption=paste0("(\U00B9) Estimate.\n(\U00B2) People living below the national poverty treshold (60% of median equivalised income).\n(\U00B3) Break in series.\n(\U2074) Low reliability.\n(\U2070) 2019 instead of 2020.\n(\U2076) 2018 instead of 2022.\nSource: Eurostat (online data code: ",idenv2, ")"))+
  theme(axis.title.x = element_blank(),
        axis.title.y=element_blank(),
        panel.grid.major.x=element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.border = element_blank(),
        axis.line.y = element_blank(),
        plot.caption = element_text(hjust=0),
        legend.position="bottom",
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 90))+
        scale_fill_manual(labels= c("Total population","Population at-risk-of-poverty(\U00B2)"), values=c("orange", "blue"))
  
```

# People who used the internet for civic or political participation, 2022.
https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Young_people_-_digital_world

## Data
```{r}
iddw1="isoc_ci_ac_i"
dw=get_eurostat_data(iddw1, filters = list(time="2022", indic_is="I_IUCPP", ind_type=c("IND_TOTAL","Y16_29"), unit="PC_IND", geo=countries ))
dw1=get_eurostat_data(iddw1, filters = list(time="2021", indic_is="I_IUCPP", ind_type=c("IND_TOTAL","Y16_29"), unit="PC_IND", geo="CH" ))

dw=rbind(dw, dw1)

```


## Graph
```{r}
ggplot(data=dw, aes(x=geo, y=values, fill=ind_type)) +
  scale_y_continuous(limits=c(0,55), breaks=seq(0,55,5))+
  geom_bar(stat="identity", position=position_dodge(), width = 0.5)+
  theme_minimal()+
 labs(title=paste0("People who used the internet for civic or political participation, \n 2022"),
    subtitle=paste0("order by young people aged 16-29 years \n(%)"),
caption=paste0("Note: for example, expressing opinions on civic or political issues or taking part in online consultations or voting to \ndefine civic or political issues\n(\U00B9) Break in time series.\n(\U00B2) Low reliability for young people.\n(\U00B3) Data from 2021.\n Source: Eurostat (online data code: ",iddw1, ")"))+
  theme(axis.title.x = element_blank(),
        axis.title.y=element_blank(),
        panel.grid.major.x=element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.border = element_blank(),
        axis.line.y = element_blank(),
        plot.caption = element_text(hjust=0),
        legend.position="bottom",
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 90))+
        scale_fill_manual(labels= c("Young people aged 16-29 years","Adult population"), values=c("orange", "blue"))
```
# People who used the internet for doing an online course

## Data
```{r}
iddw2="isoc_ci_ac_i"
dw2=get_eurostat_data(iddw2, filters = list(time="2021", indic_is="I_IUOLC", ind_type=c("IND_TOTAL","Y16_29"), unit="PC_IND", geo=countries ))
dw22=get_eurostat_data(iddw2, filters = list(time="2021", indic_is="I_IUOLC", ind_type=c("IND_TOTAL","Y16_29"), unit="PC_IND", geo=c("CH", "IS", "MK")))

dw2=rbind(dw2, dw22)
```


## Graph
```{r}
ggplot(data=dw2, aes(x=geo, y=values, fill=ind_type)) +
  scale_y_continuous(limits=c(0,70), breaks=seq(0,70,5))+
  geom_bar(stat="identity", position=position_dodge(), width = 0.5)+
  theme_minimal()+
 labs(title=paste0("People who used the internet for doing an online course, \n 2022"),
    subtitle=paste0("order by young people aged 16-29 years \n(%)"),
caption=paste0("\n(\U00B9) Low reliability for young population \n(\U00B2) Data from 2021.\n Source: Eurostat (online data code: ",iddw2, ")"))+
  theme(axis.title.x = element_blank(),
        axis.title.y=element_blank(),
        panel.grid.major.x=element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.border = element_blank(),
        axis.line.y = element_blank(),
        plot.caption = element_text(hjust=0),
        legend.position="bottom",
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 90))+
        scale_fill_manual(labels= c("Young people aged 16-29 years","Adult population"), values=c("orange", "blue"))
```

# People who have verified the information or content found on internet, 2021
https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Young_people_-_digital_world

## Data
```{r}
iddw3="isoc_sk_edic_i21"
dw3=get_eurostat_data(iddw3, filters = list(time="2021", indic_is="I_TIC", ind_type=c("IND_TOTAL","Y16_29"), unit="PC_IND", geo=countries ))
```

## Graph
```{r}
ggplot(data=dw3, aes(x=geo, y=values, fill=ind_type)) +
  scale_y_continuous(limits=c(0,100), breaks=seq(0,100,10))+
  geom_bar(stat="identity", position=position_dodge(), width = 0.5)+
  theme_minimal()+
 labs(title=paste0("Percentage of individual who have verified the information or content \nfound on internet, 2021"),
    subtitle=paste0("order by young people aged 16-29 years \n(%)"),
caption=paste0("\n(\U00B9) Low reliability for young population \n Source: Eurostat (online data code: ",iddw3, ")"))+
  theme(axis.title.x = element_blank(),
        axis.title.y=element_blank(),
        panel.grid.major.x=element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.border = element_blank(),
        axis.line.y = element_blank(),
        plot.caption = element_text(hjust=0),
        legend.position="bottom",
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 90))+
        scale_fill_manual(labels= c("Young people aged 16-29 years","Adult population"), values=c("orange", "blue"))
```
