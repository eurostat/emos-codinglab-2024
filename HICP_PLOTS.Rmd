---
title: "Consumer prices of cultural goods and services"
output:
  html_document: default
  pdf_document: default
---


#### HICP for cultural goods and services â€“ trends at EU level

In addition to the headline inflation aggerate, the 'all-items HICP', there are around 400 sub-indices for different goods and services. The article focuses on six sub-indices related to culture: books; newspapers and periodicals; equipment for the reception, recording and reproduction of sound and picture; recording media; information processing equipment and cultural services.

When analysing the HICP sub-indices related to culture, some basic trends can be observed at the EU level between 2013 and 2023:

prices of newspapers and periodicals rose faster than the other cultural goods tracked by the HICP;
over the last ten years, prices of books and cultural services rose at a modest pace;
prices of recording media decreased slightly throughout most of the period; this sub-index recorded an increase only in 2017, 2022 and 2023;
prices of information processing equipment as well as equipment for the reception, recording and reproduction of sound and picture followed a similar pattern throughout most of the period; with the exception of 2021 and 2022, when the prices of information processing equipment slightly increased.
The details of these trends are shown in Figure 1.

```{r, echo=FALSE, warning = FALSE, message = FALSE, fig.cap="Figure1: The all-items HICP and HICPs for cultural goods and services, EU, 2013-2023", fig.width=11, fig.height=6}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

library(tidyverse)
library(readxl)
library(grid)
library(png)
# Read in specific rows including time from the same sheet
time <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 1", range = "D73:N73", col_names = F, col_types = "numeric")
all_hicp <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 1", range = "D75:N75", col_names = F)
equip <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 1", range = "D77:N77", col_names = F)
info_equip <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 1", range = "D78:N78", col_names = F)
rec_media <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 1", range = "D79:N79", col_names = F)
cult_serv <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 1", range = "D80:N80", col_names = F)
books <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 1", range = "D81:N81", col_names = F)
newspapers <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 1", range = "D82:N82", col_names = F)

# Bind rows and create a new column for data frame names
combined_rows <- bind_rows(time, all_hicp, equip, info_equip,
                           rec_media, cult_serv, books, newspapers)

# Add more rows as needed using the same pattern
combined_cols <- as_tibble(t(combined_rows))
colnames(combined_cols) <- c("time","all_hicp","equip","info_equip",
                             "rec_media","cult_serv","books","newspapers")

combined_data_long <- combined_cols %>%
  pivot_longer(cols = -time, names_to = "variable", values_to = "value")

# Convert value column to numeric
combined_data_long$value <- as.numeric(combined_data_long$value)
combined_data_long$time <- as.numeric(combined_data_long$time)

# Create the factors for the legend
combined_data_long$variable <- factor(combined_data_long$variable, 
                                      levels = c("newspapers", "books", "info_equip", "all_hicp",
                                                 "cult_serv", "rec_media", "equip"))
# Create the vector for legend names 
labels_original <- c("Newspapers and periodicals", "Books", "Information Processing Equipment (3)", 
                     "All-items HICP", "Cultural Services (1)", "Recording Media (2)", "Equipment for the reception, recording and reproduction of sound and picture (4)")


# Define codes for each variable
color_palette <- c(
  all_hicp = "#d7a2db",        
  equip = "#b0185e",           
  info_equip = "#388ae2",     
  rec_media = "#672dc4",       
  cult_serv = "#2644a7",       
  books = "#b09120",           
  newspapers = "#b656bd"       
)


cap = paste("Note: average indices reflect changes in EU membership (when a Member State joins the EU, its HICPs are chained with the aggregate index at the time of the accession).
(1) Includes cinemas, theatres, concerts; museums, libraries, zoological gardens; television and radio fees, hire of equipment and accessories for culture; and other cultural services.
(2) Includes records, CDs, DVDs, tapes, cassettes, etc.
(3) Includes personal computers, visual display units, printers and miscellaneous accessories accompanying them; also computer software packages such as operating systems, applications, languages, etc.
(4) Includes TV sets, CD players, stereo systems, radios, etc.
Source: Eurostat (online data code: prc_hicp_aind)")

# Create the plot
plot1 <- ggplot(combined_data_long, aes(x = time, y = value,
                                        color = variable, shape = variable,
                                        linewidth = variable, size = variable)) +
  geom_point() +
  geom_line() +
  guides(color=guide_legend(ncol=2), shape=guide_legend(ncol=2), linewidth=F, size=F) +
  scale_shape_manual(values=c(15,17,4,21,18,4,19), labels=labels_original) +
  scale_linewidth_manual(values = c(1.1,1.1,1.1,1.8,1.1,1.1,1.1)) +
  labs(title="Harmonised indices of consumer prices for selected cultural goods and services, EU, 2013-2023",
       subtitle="(%, annual rate of change)", x = "", y = "", color = "Variable", shape = "Variable",
       cols='markers', caption=cap) +
  scale_x_continuous(breaks = seq(2013, 2023, by = 1)) +
  scale_y_continuous(breaks = seq(-10, 12, by = 2), limits = c(-10,10)) +
  scale_color_manual(values = color_palette, labels=labels_original) +
  scale_size_manual(values=c(1.8,1.8,1.8,2,1.8,1.8,1.8)) +
  theme_minimal() +
  theme(panel.background = element_rect(fill = "white"),  # Set background to white
        panel.grid.major.y = element_line(color = "gray"),  # Set major horizontal grid lines to gray
        panel.grid.minor = element_blank(),  # Remove minor grid lines
        panel.grid.major.x = element_blank(),  # Remove vertical grid lines
        panel.grid.minor.x = element_blank(),
        plot.title = element_text(face = "bold"),
        
        plot.caption = element_text(size = 8, hjust = 0, vjust = 5),
        legend.position = "bottom", legend.title = element_blank())

plot1
```
The annual average rate of change (indicated with darker bars in Figure 2) shows that, between 2018 and 2023, at the EU level, 'newspapers and periodicals' recorded the highest price increase among cultural products. The 'newspapers and periodicals' HICP increased by an average of 5.1 % per year, 1 percentage point higher than the all-items HICP. In other words, the prices of newspapers and periodicals rose faster than the headline inflation. Rates of change for 'cultural services' and 'books' sub-indices were also positive but lower than the all-items HICP. Among the remaining three groups of cultural products which saw decreases, the fall in prices was the most pronounced for the 'equipment for the reception, recording, and reproduction of sound and picture' sub-index. Prices in this category of cultural products declined between 2018 and 2023 at an average annual rate of 3.6 %.

Between 2022 and 2023, prices of 'equipment for the reception, recording, and reproduction of sound and picture' decreased by 1.7 %, while prices of 'information processing equipment' decreased by 0.5 %. Among all remaining culture-related HICPs that increased, only the prices of newspapers and periodicals rose faster than the all-items HICP (see Figure 2).

``` {r, echo=FALSE, warning = FALSE, message = FALSE, fig.cap="Figure 2: Harmonised indices of consumer prices for selected cultural goods and services, EU, annual average rates of change 2018-2023 and 2022-2023", fig.width=13, fig.height=6}
category <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 2", range = "C63:C69", col_names = FALSE)
category[7, 1] <- "Equipment for the reception, recording  
and reproduction of sound and picture (4)"
category[3, 1] <- "Cultural Servies (1)"
category[5,1] <- "Recording Media (2)"
category[6, 1] <- "Information processing equipment (3)"
values_2018_2023 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 2", range = "E63:E69", col_names = FALSE)
values_2022_2023 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 2", range = "F63:F69", col_names = FALSE)
period <-  as.character(read_excel("EU_HICP_DATA_24.xlsx", sheet = "Figure 2", range = "E59:F59", col_names = FALSE))

data <- data.frame(
  Category = category[[1]],
  `2022-2023` = values_2022_2023[[1]],
  `2018-2023` = values_2018_2023[[1]])

cap2 = "Note: average indices reflect changes in EU membership (when a Member State joins the EU, its HICPs are chained with the aggregate index at the time of the accession).
 (1) Includes cinemas, theatres, concerts; museums, libraries, zoological gardens; television and radio fees, hire of equipment and accessories for culture; and other cultural services.
 (2) Includes records, CDs, DVDs, tapes, cassettes, etc.
 (3) Includes personal computers, visual display units, printers and miscellaneous accessories accompanying them; also computer software packages such as operating systems, applications, languages, etc. 
 (4) Includes TV sets, CD players, stereo systems, radios, etc.
 Source: Eurostat (online data code: prc_hicp_aind)"

# Pivot the data to a long format
data_long <- pivot_longer(data, cols = -Category,names_to = "Period",values_to = "Value")


labels_graph2 <- data_long$Category |> unique() |> rev()
data_long$Category <- factor(data_long$Category, levels = labels_graph2)
data_long$Period <- rev(factor(data_long$Period))

data_long <- data_long %>%
  mutate(Color_Group = ifelse(Category == "All-items HICP", paste(Category, Period), paste("Other", Period)))

plot <- ggplot(data_long, aes(x = Category, y = Value, fill = Color_Group)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  coord_flip() +  # This flips the axes so categories are on the y-axis
  scale_fill_manual(values = c(
    "All-items HICP X2018.2023" = "#e2bbe5", 
    "All-items HICP X2022.2023" = "#b656bd",
    "Other X2018.2023" = "#9cade8", 
    "Other X2022.2023" = "#2644a7"
  ),
  breaks = c("Other X2018.2023","Other X2022.2023"),
  labels = c("2018-2023","2022-2023")) +  # Customize the colors for each specific group
  labs(title = "Harmonised Indices of Consumer Prices for Selected Cultural Goods and Services",
       subtitle = "EU, Annual Average Rates of Change 2018-2023 and 2022-2023",
       x = "",
       y = "",
       caption = cap2) +
  theme_minimal() +
  theme(legend.position = "bottom", legend.title = element_blank(),
        plot.title = element_text(size = 14, face = "bold"),
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 7, hjust = 0),
        
        panel.grid.major.y = element_blank()) +
  
  scale_y_continuous(breaks = c(seq(-4, 6, by = 2)), minor_breaks= c(seq(-4, 6, by = 2)))


# Display the plot
print(plot)

```

### HICP for cultural goods and services â€“ focus on countries

Data on consumer price development for cultural goods and services are presented in Table 1. It shows the change in the average annual rates of cultural goods and services price indices in EU countries between 2018 and 2023 and between 2022 and 2023. In 2018-2023, the annual average rate of change of all-items HICP in the EU was 4.1 %. Nine EU countries recorded a rate of change of more than 5 % a year in their all items HICP in that period. Between 2022 and 2023, the rate of change of the all-items HICP was 6.4 % in the EU, with four Member States experiencing double-digit inflation rates during this period.

#### All EU countries saw a rise in newspapers prices over the past five years

In 2018-2023, all the EU countries saw a rise in 'newspapers and periodical' prices. Over that period, the annual average rate of change for this category was higher than for the headline inflation in 20 EU Member States. Between 2022 and 2023 prices of newspapers and periodicals grew faster than the headline inflation in 16 EU countries. During that one-year period, the highest price growth for newspapers and periodicals was recorded in Hungary (21.0 %) and Romania (19.6 %).

Between 2018 and 2023, the annual average rate of change for the prices of 'cultural services' was slower than the overall inflation rate in all EU Member States, except Estonia and Denmark. The fastest growth rates for cultural services prices (over 5 % per year, on average) were recorded in the Baltic Member States and Poland. Slovakia was the only country where the price index of cultural services decreased in 2023 compared with 2018. Between 2022 and 2023, the 'cultural services' sub-index grew faster compared with the all-items HICP in 9 EU Member States.

In 2023, the annual average price index for books was lower in four EU countries compared with 2018. The decline in book prices between these years was most noticeable in Portugal, where the 'Books' sub-index recorded an average decrease of 12.8 % per year. Between 2018 and 2023, average book prices rose faster than the headline inflation rate in only three EU countries â€“ Denmark, Malta and Sweden. From 2022 to 2023, annual average book price index increased faster than the headline inflation rate in only three EU countries â€“ Denmark, Malta and Sweden. From 2022 to 2023, annual average book price index increased faster than the headline inflation in Croatia, Belgium, Sweden, Luxembourg and Spain.

In the five-year period between 2018 and 2023, the sub-index for 'recording media' decreased in 17 EU Member States (no data for Malta). The price index for 'recording media' fell the fastest in Slovenia (-8.8 % per year, on average) and Finland (-5.1 %). However, in 2023, prices for 'recording media' increased in 18 EU Member States compared with the previous year, with the largest increases in Estonia (13.0 %) and Sweden (11.8 %).

#### The prices of information processing equipment returned to a downward trend

Between 2018 and 2023, the 'information processing equipment' index decreased in 16 EU Member States. The largest annual average decrease in the index was recorded in Estonia (-8.4 % per year), while the largest annual average increase of 'information processing equipment' price index occurred in Romania (2.8 %). From 2022 to 2023, the 'information processing equipment' index decreased in 14 EU Member States, with the largest decreases observed in Estonia (-10.6 %) and Spain (-6.7 %). During the same period, the largest increases in information processing equipment prices were observed in Italy (5.8 %) and Romania (5.1 %).

The index for 'equipment for the reception, recording, and reproduction of sound and picture' saw the most significant decline between 2018 and 2023 in Italy (on average -12.3 % a year). Slight increases in this index were observed in Romania, Austria and Estonia (1.6 %, 0.2 %, and 0.1 % a year on average, respectively). Between 2022 and 2023, the index for this type of equipment decreased in 20 EU countries, with the largest drops recorded in Belgium (-12.5 %), Bulgaria and Luxembourg (-12.3 % in both countries).
```{r}

```

``` {r, suppress-tibble-info, echo=FALSE, warning = FALSE, message = FALSE}
options(pillar.sigfig = NULL)
options(tibble.print_min = Inf, tibble.print_max = Inf)
time_t <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "D10:Q10", col_names = F, col_types = "text")

all_hicp_t1 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "D11:D47", col_names = F, col_types = "numeric")
all_hicp_t2 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "E11:E47", col_names = F, col_types = "numeric")
newspapers_t1 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "F11:F47", col_names = F, col_types = "numeric")
newspapers_t2 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "G11:G47", col_names = F, col_types = "numeric")
cult_serv_t1 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "H11:H47", col_names = F, col_types = "numeric")
cult_serv_t2 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "I11:I47", col_names = F, col_types = "numeric")
books_t1 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "J11:J47", col_names = F, col_types = "numeric")
books_t2 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "K11:K47", col_names = F, col_types = "numeric")
rec_media_t1 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "L11:L47", col_names = F, col_types = "numeric")
rec_media_t2 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "M11:M47", col_names = F, col_types = "numeric")
info_equip_t1 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "N11:N47", col_names = F, col_types = "numeric")
info_equip_t2 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "O11:O47", col_names = F, col_types = "numeric")
equip_t1 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "P11:P47", col_names = F, col_types = "numeric")
equip_t2 <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "Q11:Q47", col_names = F, col_types = "numeric")

categories <- read_excel("EU_HICP_DATA_24.xlsx", sheet = "Table 1", range = "C11:C47", col_names = F)

combined_cols <- bind_cols(categories, all_hicp_t1, all_hicp_t2, newspapers_t1, newspapers_t2, cult_serv_t1, cult_serv_t2,
                           books_t1, books_t2, rec_media_t1, rec_media_t2, info_equip_t1, info_equip_t2, equip_t1, 
                           equip_t2)

colnames(combined_cols) <- c(" ",time_t)


library(knitr)
library(kableExtra)

header <- c(1, rep(2,7))
names(header) <- c(" ", rev(labels_graph2))

# Create the table
kable_styling <- kable(combined_cols, format = "html", escape = F, digits = 1) %>%
  group_rows(" ", 1, 1) %>%
  group_rows(" ", 2, 28) %>%
  group_rows(" ", 29, 31) %>%
  group_rows(" ", 32, 36) %>%
  group_rows(" ", 37, 37) %>%
  add_header_above(header, background = "#f0dcf1", include_empty = F) %>%
  row_spec(row = 0, background = "#f0dcf1") %>%
  row_spec(row = 1, background = "#e1bae4") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                full_width = F, font_size = 12, fixed_thead = TRUE)

# Output the table
kable_styling


```
