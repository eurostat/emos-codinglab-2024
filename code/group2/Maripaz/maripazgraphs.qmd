---

---

---
title: "emos"
author: "Maripaz Venegas"
date: "2024-04-22"
output: html
---

# Libraries

```{r}
library(restatapi)
library(ggplot2)
library(restatapi)
library(giscoR) 
library(data.table)
library(chron) 
library(reshape2)
library(kableExtra)
#library(tmap) 
library(highcharter)
library(plotly)
library(dplyr)
```

# Countries - Code and name

# Population reporting noise from neighbours or from the street, EU (1), 2011-2020

<https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Quality_of_life_indicators_-_natural_and_living_environment>

<https://ec.europa.eu/eurostat/statistics-explained/index.php?title=File:Population_reporting_noise_from_neighbours_or_from_the_street,>*EU*(%C2%B9)\_,*2011-2020*(%25).png

## Data

```{r}
idenv="ilc_mddw01"
dates=2011:2020

env=get_eurostat_data(idenv, filters = list(hhtyp="TOTAL", incgrp="TOTAL", geo="EU27_2020", time=dates))
```

## Graph

```{r}
#Title
tit=paste0("Population reporting noise from neighbours or from the street, \n EU(\U00B9)",dates[1],"-",dates[length(dates)])

#Subtitle
subtit=paste("(%)")

#Caption
cap=paste0("(\U00B9) Estimate \n Source: Eurostat (online data code: ",idenv, ")")

#Color
col="#F8AE21"

ggplot(env, aes(x=time, y=values, group=1)) +

  scale_y_continuous(limits=c(0,20), breaks=seq(0,20,2))+
  geom_line(color=col, linewidth=1) +
  theme_minimal()+
  labs(
    title=tit,
    subtitle=subtit,
    caption=cap)+
        theme_bw()+
      theme(axis.title.x = element_blank(),
            axis.title.y=element_blank(),
            panel.grid.major.x=element_blank(),
            panel.grid.minor.x = element_blank(),
            panel.grid.minor.y = element_blank(),
            panel.border = element_blank(),
            axis.line.y = element_blank(),
            axis.line.x = element_line(colour = "black",linetype = "solid"),
            plot.caption = element_text(hjust = 0),
            plot.title = element_text(hjust = 0, face = "bold"),
            axis.text.x = element_text(hjust = 1.5)
            )+
  ylab("")+
  xlab("")
```

# Population reporting noise from neighbours or from the street, by income situation, 2020

<https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Quality_of_life_indicators_-_natural_and_living_environment>

<https://ec.europa.eu/eurostat/statistics-explained/index.php?title=File:Population_reporting_noise_from_neighbours_or_from_the_street,_by_income_situation,>*2020*(%25).png

## Data

```{r}
idenv2="ilc_mddw01"
date=2020

eu_cc<-get("cc",envir=.restatapi_env)$EU27_2020
efta_cc<-c("CH","NO","IS","LI")

env2=get_eurostat_data(idenv2, filters = list(incgrp=c("B_MD60", "TOTAL"), hhtyp="TOTAL",time=date),  label=T,
  ignore.case=T,
  exact_match=F,
  perl=T,
  stringsAsFactors=F,
  force_local_filter=T)
env2a=get_eurostat_data(idenv2, filters = list(incgrp=c("B_MD60", "TOTAL"), hhtyp="TOTAL",time=2019, geo="Poland"),  label=T,
  ignore.case=T,
  exact_match=F,
  perl=T,
  stringsAsFactors=F,
  force_local_filter=T)
env2b=get_eurostat_data(idenv2, filters = list(incgrp=c("B_MD60", "TOTAL"), hhtyp="TOTAL",time=2018, geo="Iceland"),  label=T,
  ignore.case=T,
  exact_match=F,
  perl=T,
  stringsAsFactors=F,
  force_local_filter=T)
env2=rbind(env2, env2a, env2b)


dsd<-as.data.table(get_eurostat_dsd(idenv2))[concept=="geo",c("code","name")]

env2<-merge(env2,
                dsd,
                by.x="geo",
                by.y="name", 
                all.x=T, 
                all.y = F)

env2 <- env2[!code %in% c("EA19", "EA18", "EA", 
                                  "EU28", "EU27_2007", "EU")]

env2$geo<-gsub(" \\(.*\\)","",env2$geo)


env2$geo<-gsub("^Eu.*","EU",env2$geo)

name_ord <- env2[(code %in% eu_cc) & (incgrp == "Total")]

name_ord_eu<-name_ord[order(values)]$geo

name_ord<-env2[(code %in% efta_cc) & (incgrp == "Total")]

name_ord_efta<-name_ord[order(values)]$geo

name_ord<-env2[!(code %in% c(efta_cc,eu_cc,"EU27_2020")) & (incgrp == "Total")]

name_ord_othr<-name_ord[order(values)]$geo

name_ord<-c(name_ord_othr, " " ,name_ord_efta, "  " ,name_ord_eu, "   ", "EU")

env2 <- env2 |>
  select(geo, incgrp, values) |>
  mutate(incgrp = recode(incgrp,
                         "Below 60% of median equivalised income" = "Population at-risk-of-poverty (\U00B2)")) |>
  (\(df){
    dt_sep <- data.table::data.table(
      geo = c(" ", "  ", "   "),
      incgrp = rep("Total", 3),
      values = rep(NA, 3)
    )
    rbind(df, dt_sep)
  })()

env2$geo <- factor(env2$geo,levels = rev(name_ord))
env2$incgrp <- factor(env2$incgrp, levels = c("Total", "Population at-risk-of-poverty (\U00B2)"))

env2 <- env2 |>
  mutate(geo = recode(geo,
                      "EU" = "EU (\U00B9)",
                      "Germany" = "Germany (\U00B3)(\U2074)",
                      "France" = "France (\U00B3)",
                      "Luxembourg" = "Luxembourg (\U00B3)",
                      "Poland"="Poland(\U2075)",
                      "Iceland" = "Iceland (\U2076)",
                      
))
```

## Graph

```{r}
#Colors
col1="#F8AE21"
col2="#003776"

#Title
tit=paste0("Population reporting noise from neighbours or from the street by, \n income situation, ", date)

#Subtitle
subtit=paste("(%)")

#Caption
cap=paste0("(\U00B9) Estimate.
           \n(\U00B2) People living below the national poverty treshold (60% of median equivalised income).
           \n(\U00B3) Break in series.
           \n(\U2074) Low reliability.
           \n(\U2075) 2019 instead of 2020.
           \n(\U2076) 2018 instead of 2020.
           \nSource: Eurostat (online data code: ",idenv2, ")")

ggplot(data=env2, aes(x=geo, y=values, fill=incgrp)) +
  scale_y_continuous(expand = c(0, 0), 
                     limits = c(0, max(env2$values, na.rm = TRUE)+5),
                     breaks = seq(0, max(env2$values,na.rm = TRUE)+5, 5))+
  geom_bar(stat="identity", position=position_dodge(), width = 0.5)+
  theme_bw()+
   labs(title=tit,
    subtitle=subtit,
  caption=cap)+
  theme(
    axis.text.x = element_text(angle = 60, hjust = 1),
    axis.title.x = element_blank(),
    axis.title.y=element_blank(),
    panel.grid.major.x=element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.minor.y = element_blank(),
    panel.border = element_blank(),
    axis.line.y = element_blank(),
    axis.line.x = element_line(colour = "black",linetype = "solid"),
    plot.caption = element_text(hjust = 0),
    plot.title = element_text(hjust = 0, face = "bold"),
    legend.position = "bottom",
    legend.title = element_blank()
  )+
        scale_fill_manual(values=c(col1, col2))
  
```

# People who used the internet for civic or political participation, 2022.

<https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Young_people_-_digital_world>

<https://ec.europa.eu/eurostat/statistics-explained/index.php?title=File:Figure_3_People_who_used_the_internet_for_civic_or_political_participation,>*2022_order_by_young_people_aged_16-29_years*(%25).png

## Data

```{r}
iddw1="isoc_ci_ac_i"
date=2022

eu_cc<-get("cc",envir=.restatapi_env)$EU27_2020
efta_cc<-c("CH","NO","IS","LI")

dw=get_eurostat_data(iddw1, filters = list(time=2022, indic_is="I_IUCPP", ind_type=c("IND_TOTAL","Y16_29"), unit="PC_IND"),
label=T,
  ignore.case=T,
  exact_match=T,
  perl=T,
  stringsAsFactors=F,
  force_local_filter=T)
dwa=get_eurostat_data(iddw1, filters = list(time=2021, indic_is="I_IUCPP", ind_type=c("IND_TOTAL","Y16_29"), unit="PC_IND", geo="CH" ), 
                      label=T,
  ignore.case=T,
  exact_match=T,
  perl=T,
  stringsAsFactors=F,
  force_local_filter=T)

dw=rbind(dw, dwa)

dsd<-as.data.table(get_eurostat_dsd(idenv2))[concept=="geo",c("code","name")]

dw<-merge(dw,
                dsd,
                by.x="geo",
                by.y="name", 
                all.x=T, 
                all.y = F)

dw <- dw[!code %in% c("EA19", "EA18", "EA", 
                                  "EU28", "EU27_2007", "EU")]

dw$geo<-gsub(" \\(.*\\)","",dw$geo)


dw$geo<-gsub("^Eu.*","EU",dw$geo)

name_ord <- dw[(code %in% eu_cc) & (ind_type=="Individuals, 16 to 29 years old")]

name_ord_eu<-name_ord[order(values)]$geo

name_ord<-dw[(code %in% efta_cc) & (ind_type=="Individuals, 16 to 29 years old")]

name_ord_efta<-name_ord[order(values)]$geo

name_ord<-dw[!(code %in% c(efta_cc,eu_cc,"EU27_2020")) & (ind_type=="Individuals, 16 to 29 years old")]

name_ord_othr<-name_ord[order(values)]$geo

name_ord<-c(name_ord_othr, " " ,name_ord_efta, "  " ,name_ord_eu, "   ", "EU")

dw <- dw |>
  select(geo, ind_type, values) |>
  mutate(ind_type = recode(ind_type,
                         "Individuals, 16 to 29 years old" = "Young people aged 16-29 years", "All Individuals"="Adult population")) |>
  (\(df){
    dt_sep <- data.table::data.table(
      geo = c(" ", "  ", "   "),
      ind_type = rep("Young people aged 16-29 years", 3),
      values = rep(NA, 3)
    )
    rbind(df, dt_sep)
  })()

dw$geo <- factor(dw$geo,levels = rev(name_ord))
dw$ind_type <- factor(dw$ind_type, levels = c("Young people aged 16-29 years", "Adult population"))

dw <- dw |>
  mutate(geo = recode(geo,
                      "EU" = "EU (\U00B9)",
                      "Ireland" = "Ireland (\U00B9)(\U00B2)",
                      "Germany"= "Germany (\U00B9)",
                      "Iceland" = "Iceland (\U00B3)",
                      "Switzerland" = "Switzerland (\U00B3)",
                      "Albania"="Albania (\U00B3)",
                      "North Macedonia" = "North Macedonia(\U00B3)",
                      
))
```

## Graph

```{r}
#Colors
col1="#F8AE21"
col2="#003776"

#title
tit=paste0("People who used the internet for civic or political participation, \n ", date)

#subtitle
subtit=paste0("order by young people aged 16-29 years \n(%)")

#caption
cap=paste0("Note: for example, expressing opinions on civic or political issues or taking part in online consultations or voting to
          \ndefine civic or political issues
           \n(\U00B9) Break in time series.
           \n(\U00B2) Low reliability for young people.
           \n(\U00B3) Data from 2021.
           \nSource: Eurostat (online data code: ",iddw1, ")")
  
ggplot(data=dw, aes(x=geo, y=values, fill=ind_type)) +
  scale_y_continuous(expand = c(0, 0), 
                     limits = c(0, max(dw$values, na.rm = TRUE)+5),
                     breaks = seq(0, max(dw$values,na.rm = TRUE)+5, 5))+
  geom_bar(stat="identity", position=position_dodge(), width = 0.5)+
  theme_minimal()+
 labs(title=tit,
    subtitle=subtit,
caption=cap)+
  theme(axis.title.x = element_blank(),
        axis.title.y=element_blank(),
        panel.grid.major.x=element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.border = element_blank(),
        axis.line.y = element_blank(),
        plot.caption = element_text(hjust=0),
        legend.position="bottom",
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 90, hjust=1))+
        scale_fill_manual(values=c(col1, col2))
```

# People who used the internet for doing an online course

<https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Young_people_-_digital_world>

<https://ec.europa.eu/eurostat/statistics-explained/index.php?title=File:Fig_4_People_who_used_the_internet_for_doing_an_online_course,>*2022_order_by_young_people_aged_16-29_years*(%25).png

## Data

```{r}
iddw2="isoc_ci_ac_i"
date=2022

eu_cc<-get("cc",envir=.restatapi_env)$EU27_2020
efta_cc<-c("CH","NO","IS","LI")


dw2=get_eurostat_data(iddw2, filters = list(time=2022, indic_is="I_IUOLC", ind_type=c("IND_TOTAL","Y16_29"), unit="PC_IND"),
label=T,
  ignore.case=T,
  exact_match=T,
  perl=T,
  stringsAsFactors=F,
  force_local_filter=T)
dw2a=get_eurostat_data(iddw2, filters = list(time="2021", indic_is="I_IUOLC", ind_type=c("IND_TOTAL","Y16_29"), unit="PC_IND", geo=c("CH", "IS", "MK")),
                       label=T,
  ignore.case=T,
  exact_match=T,
  perl=T,
  stringsAsFactors=F,
  force_local_filter=T)

dw2=rbind(dw2, dw2a)

dsd<-as.data.table(get_eurostat_dsd(idenv2))[concept=="geo",c("code","name")]

dw2<-merge(dw2,
                dsd,
                by.x="geo",
                by.y="name", 
                all.x=T, 
                all.y = F)

dw2 <- dw2[!code %in% c("EA19", "EA18", "EA", 
                                  "EU28", "EU27_2007", "EU")]

dw2$geo<-gsub(" \\(.*\\)","",dw2$geo)


dw2$geo<-gsub("^Eu.*","EU",dw2$geo)

name_ord <- dw2[(code %in% eu_cc) & (ind_type=="Individuals, 16 to 29 years old")]

name_ord_eu<-name_ord[order(values)]$geo

name_ord<-dw2[(code %in% efta_cc) & (ind_type=="Individuals, 16 to 29 years old")]

name_ord_efta<-name_ord[order(values)]$geo

name_ord<-dw2[!(code %in% c(efta_cc,eu_cc,"EU27_2020")) & (ind_type=="Individuals, 16 to 29 years old")]

name_ord_othr<-name_ord[order(values)]$geo

name_ord<-c(name_ord_othr, " " ,name_ord_efta, "  " ,name_ord_eu, "   ", "EU")

dw2 <- dw2 |>
  select(geo, ind_type, values) |>
  mutate(ind_type = recode(ind_type,
                         "Individuals, 16 to 29 years old" = "Young people aged 16-29 years", "All Individuals"="Adult population")) |>
  (\(df){
    dt_sep <- data.table::data.table(
      geo = c(" ", "  ", "   "),
      ind_type = rep("Young people aged 16-29 years", 3),
      values = rep(NA, 3)
    )
    rbind(df, dt_sep)
  })()

dw2$geo <- factor(dw2$geo,levels = rev(name_ord))
dw2$ind_type <- factor(dw2$ind_type, levels = c("Young people aged 16-29 years", "Adult population"))

dw2 <- dw2 |>
  mutate(geo = recode(geo,
                      "Ireland" = "Ireland (\U00B9)",
                      "Iceland" = "Iceland (\U00B2)",
                      "Switzerland" = "Switzerland (\U00B2)",
                      "Albania"="Albania (\U00B2)",
                      "North Macedonia" = "North Macedonia(\U00B2)"
                      
))
```

## Graph

```{r}
#Colors
col1="#F8AE21"
col2="#003776"

#Title
tit=paste0("People who used the internet for doing an online course, ", date)
  
#Subtitle
subtit=paste0("order by young people aged 16-29 years \n(%)")
  
#caption
cap=paste0("\n(\U00B9) Low reliability for young population
           \n(\U00B2) Data from 2021.
           \nSource: Eurostat (online data code: ",iddw2, ")")
  
ggplot(data=dw2, aes(x=geo, y=values, fill=ind_type)) +
  scale_y_continuous(expand = c(0, 0), 
                     limits = c(0, max(dw2$values, na.rm = TRUE)+5),
                     breaks = seq(0, max(dw2$values,na.rm = TRUE)+5, 5))+
  geom_bar(stat="identity", position=position_dodge(), width = 0.5)+
  theme_minimal()+
 labs(title=tit,
    subtitle=subtit,
caption=cap)+
  theme(axis.title.x = element_blank(),
        axis.title.y=element_blank(),
        panel.grid.major.x=element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.border = element_blank(),
        axis.line.y = element_blank(),
        plot.caption = element_text(hjust=0),
        legend.position="bottom",
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 90, hjust=1))+
        scale_fill_manual(values=c(col1, col2))
```

# People who have verified the information or content found on internet, 2021

<https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Young_people_-_digital_world>

<https://ec.europa.eu/eurostat/statistics-explained/index.php?title=File:Figure_5_Percentage_of_individuals_who_have_verified_the_information_or_content_found_on_internet,>*2021_order_by_young_people_aged_16-29_years*(%25).png

## Data

```{r}
iddw3="isoc_sk_edic_i21"
date=2021

eu_cc<-get("cc",envir=.restatapi_env)$EU27_2020
efta_cc<-c("CH","NO","IS","LI")

dw3=get_eurostat_data(iddw3, filters = list(time=date, indic_is="I_TIC", ind_type=c("IND_TOTAL","Y16_29"), unit="PC_IND"),
label=T,
  ignore.case=T,
  exact_match=T,
  perl=T,
  stringsAsFactors=F,
  force_local_filter=T)

dsd<-as.data.table(get_eurostat_dsd(iddw3))[concept=="geo",c("code","name")]

dw3<-merge(dw3,
                dsd,
                by.x="geo",
                by.y="name", 
                all.x=T, 
                all.y = F)

dw3 <- dw3[!code %in% c("EA19", "EA18", "EA", 
                                  "EU28", "EU27_2007", "EU")]

dw3$geo<-gsub(" \\(.*\\)","",dw3$geo)


dw3$geo<-gsub("^Eu.*","EU",dw3$geo)

name_ord <- dw3[(code %in% eu_cc) & (ind_type=="Individuals, 16 to 29 years old")]

name_ord_eu<-name_ord[order(values)]$geo

name_ord<-dw3[(code %in% efta_cc) & (ind_type=="Individuals, 16 to 29 years old")]

name_ord_efta<-name_ord[order(values)]$geo

name_ord<-dw3[!(code %in% c(efta_cc,eu_cc,"EU27_2020")) & (ind_type=="Individuals, 16 to 29 years old")]

name_ord_othr<-name_ord[order(values)]$geo

name_ord<-c(name_ord_othr, " " ,name_ord_efta, "  " ,name_ord_eu, "   ", "EU")

dw3 <- dw3 |>
  select(geo, ind_type, values) |>
  mutate(ind_type = recode(ind_type,
                         "Individuals, 16 to 29 years old" = "Young people aged 16-29 years", "All Individuals"="Adult population")) |>
  (\(df){
    dt_sep <- data.table::data.table(
      geo = c(" ", "  ", "   "),
      ind_type = rep("Young people aged 16-29 years", 3),
      values = rep(NA, 3)
    )
    rbind(df, dt_sep)
  })()

dw3$geo <- factor(dw3$geo,levels = rev(name_ord))
dw3$ind_type <- factor(dw3$ind_type, levels = c("Young people aged 16-29 years", "Adult population"))

dw3 <- dw3 |>
  mutate(geo = recode(geo,
                      "Ireland" = "Ireland (\U00B9)"
                      
))

```

## Graph

```{r}
#Colors
col1="#F8AE21"
col2="#003776"

#Title
tit=paste0("Percentage of individual who have verified the information or content \nfound on internet, ", date)

#Subtitle
subtit=paste0("order by young people aged 16-29 years \n(%)")

#Caption
cap=paste0("\n(\U00B9) Low reliability for young population
          \nSource: Eurostat (online data code: ",iddw3, ")")

ggplot(data=dw3, aes(x=geo, y=values, fill=ind_type)) +
  scale_y_continuous(limits=c(0,100), breaks=seq(0,100,10))+
  geom_bar(stat="identity", position=position_dodge(), width = 0.5)+
  theme_minimal()+
 labs(title=tit,
    subtitle=subtit,
caption=cap)+
  theme(axis.title.x = element_blank(),
        axis.title.y=element_blank(),
        panel.grid.major.x=element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.border = element_blank(),
        axis.line.y = element_blank(),
        plot.caption = element_text(hjust=0),
        legend.position="bottom",
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 90, hjust=1))+
        scale_fill_manual(values=c(col1, col2))
```
